local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local player = Players.LocalPlayer

local allowedUserId = 7843193958 -- AlgdBruce's UserId
if player.UserId ~= allowedUserId then
    player:Kick("cr7me said no")
    return
end

local guiToggleKey = Enum.KeyCode.M
local guiVisible = false -- start hidden until loaded
local isFPSBoosted = false
local isAnimating = false
local isIdleActive = false
local speedMultiplier = 2

-- Save default lighting
local originalLighting = {
    Brightness = Lighting.Brightness,
    GlobalShadows = Lighting.GlobalShadows,
    FogEnd = Lighting.FogEnd,
    Technology = Lighting.Technology,
}

-- Loading Screen
local loadingGui = Instance.new("ScreenGui")
loadingGui.Name = "LoadingScreen"
loadingGui.ResetOnSpawn = false
loadingGui.Parent = player:WaitForChild("PlayerGui")

local loadingFrame = Instance.new("Frame")
loadingFrame.Size = UDim2.new(1, 0, 1, 0)
loadingFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 20)
loadingFrame.Parent = loadingGui

local loadingLabel = Instance.new("TextLabel")
loadingLabel.Size = UDim2.new(1, 0, 0, 50)
loadingLabel.Position = UDim2.new(0, 0, 0.5, -25)
loadingLabel.BackgroundTransparency = 1
loadingLabel.Text = "ZACK MY SON XD"
loadingLabel.TextColor3 = Color3.new(1, 1, 1)
loadingLabel.Font = Enum.Font.GothamBold
loadingLabel.TextScaled = true
loadingLabel.Parent = loadingFrame

task.wait(2) -- Show loading for 2 seconds
loadingGui:Destroy()
guiVisible = true

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CR7MEWARE_GUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Create Main Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 300, 0, 260)
frame.Position = UDim2.new(0.5, -150, 0.5, -130)
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
frame.Active = true
frame.Draggable = true
frame.Visible = guiVisible
frame.Parent = screenGui
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 12)

-- Title Label
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 0)
title.Text = "CR7MEWARE"
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.TextColor3 = Color3.new(1, 1, 1)
title.BackgroundTransparency = 1
title.Parent = frame

-- Tab Buttons
local function createTabButton(name, pos)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 140, 0, 30)
    btn.Position = pos
    btn.Text = name
    btn.Font = Enum.Font.Gotham
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    btn.Parent = frame
    return btn
end

local tabMain = createTabButton("Main", UDim2.new(0, 10, 0, 35))
local tabExtra = createTabButton("Extra", UDim2.new(0, 150, 0, 35))

-- Page Container
local function createPage()
    local scroll = Instance.new("ScrollingFrame")
    scroll.Size = UDim2.new(1, -20, 1, -80)
    scroll.Position = UDim2.new(0, 10, 0, 70)
    scroll.BackgroundTransparency = 1
    scroll.CanvasSize = UDim2.new(0, 0, 2, 0)
    scroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
    scroll.ScrollBarThickness = 6
    return scroll
end

local pageMain = createPage()
local pageExtra = createPage()
pageMain.Parent = frame
pageExtra.Parent = frame
pageExtra.Visible = false

local function switchTab(toMain)
    pageMain.Visible = toMain
    pageExtra.Visible = not toMain
end

tabMain.MouseButton1Click:Connect(function() switchTab(true) end)
tabExtra.MouseButton1Click:Connect(function() switchTab(false) end)

-- Create Styled Button
local function makeButton(parent, text, pos)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 260, 0, 30)
    btn.Position = pos
    btn.Text = text
    btn.Font = Enum.Font.Gotham
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    btn.Parent = parent
    return btn
end

-- Main Tab Elements
local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(0, 260, 0, 30)
statusLabel.Position = UDim2.new(0, 0, 0, 0)
statusLabel.Text = "Disabled"
statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextScaled = true
statusLabel.BackgroundTransparency = 1
statusLabel.Parent = pageMain

local onButton = makeButton(pageMain, "On", UDim2.new(0, 0, 0, 40))
local offButton = makeButton(pageMain, "Off", UDim2.new(0, 0, 0, 80))
local idleButton = makeButton(pageMain, "Idle Off", UDim2.new(0, 0, 0, 120))
local increaseButton = makeButton(pageMain, "Increase Speed", UDim2.new(0, 0, 0, 160))
local decreaseButton = makeButton(pageMain, "Decrease Speed", UDim2.new(0, 0, 0, 200))

local speedBox = Instance.new("TextBox")
speedBox.Size = UDim2.new(0, 260, 0, 30)
speedBox.Position = UDim2.new(0, 0, 0, 240)
speedBox.PlaceholderText = "Enter Speed"
speedBox.Text = "2"
speedBox.TextScaled = true
speedBox.Font = Enum.Font.Gotham
speedBox.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
speedBox.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", speedBox).CornerRadius = UDim.new(0, 8)
speedBox.Parent = pageMain

-- Button Logic
onButton.MouseButton1Click:Connect(function()
    speedMultiplier = tonumber(speedBox.Text) or 2
    statusLabel.Text = "Enabled"
    statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
    if not isAnimating then
        isAnimating = true
        coroutine.wrap(function()
            while isAnimating do
                local char = player.Character
                if char then
                    local hum = char:FindFirstChildOfClass("Humanoid")
                    if hum then
                        for _, anim in pairs(hum:GetPlayingAnimationTracks()) do
                            if isIdleActive then
                                anim:AdjustSpeed(hum.MoveDirection.Magnitude == 0 and speedMultiplier or 1)
                            else
                                anim:AdjustSpeed(speedMultiplier)
                            end
                        end
                    end
                end
                task.wait(0.1)
            end
        end)()
    end
end)

offButton.MouseButton1Click:Connect(function()
    statusLabel.Text = "Disabled"
    statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
    isAnimating = false
end)

idleButton.MouseButton1Click:Connect(function()
    isIdleActive = not isIdleActive
    idleButton.Text = isIdleActive and "Idle On" or "Idle Off"
end)

increaseButton.MouseButton1Click:Connect(function()
    local val = tonumber(speedBox.Text) or 2
    speedBox.Text = tostring(val + 1)
end)

decreaseButton.MouseButton1Click:Connect(function()
    local val = tonumber(speedBox.Text) or 2
    val = math.max(0, val - 1)
    speedBox.Text = tostring(val)
end)

-- Extra Tab Elements
local destroyButton = makeButton(pageExtra, "Destroy GUI", UDim2.new(0, 0, 0, 0))
destroyButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

local fpsButton = makeButton(pageExtra, "Toggle FPS Boost", UDim2.new(0, 0, 0, 40))
fpsButton.MouseButton1Click:Connect(function()
    if not isFPSBoosted then
        Lighting.GlobalShadows = false
        Lighting.Brightness = 0
        Lighting.FogEnd = 1e10
        Lighting.Technology = Enum.Technology.Compatibility
        for _, obj in ipairs(workspace:GetDescendants()) do
            if obj:IsA("Accessory") or obj:IsA("Hat") or obj:IsA("Decal") or obj:IsA("Texture")
            or obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Smoke") or obj:IsA("Fire")
            or obj:IsA("Shirt") or obj:IsA("Pants") or obj:IsA("Explosion") or obj:IsA("ForceField")
            or obj:IsA("Beam") or (obj.Name:lower():find("tree")) then
                pcall(function() obj:Destroy() end)
            end
        end
        isFPSBoosted = true
        fpsButton.Text = "Restore Graphics"
    else
        Lighting.Brightness = originalLighting.Brightness
        Lighting.FogEnd = originalLighting.FogEnd
        Lighting.GlobalShadows = originalLighting.GlobalShadows
        Lighting.Technology = originalLighting.Technology
        isFPSBoosted = false
        fpsButton.Text = "Toggle FPS Boost"
    end
end)

local keybindBox = Instance.new("TextBox")
keybindBox.Size = UDim2.new(0, 260, 0, 30)
keybindBox.Position = UDim2.new(0, 0, 0, 80)
keybindBox.PlaceholderText = "Enter new key (e.g. M)"
keybindBox.Font = Enum.Font.Gotham
keybindBox.Text = ""
keybindBox.TextScaled = true
keybindBox.TextColor3 = Color3.new(1, 1, 1)
keybindBox.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
Instance.new("UICorner", keybindBox).CornerRadius = UDim.new(0, 8)
keybindBox.Parent = pageExtra

keybindBox.FocusLost:Connect(function()
    local key = keybindBox.Text:upper()
    if Enum.KeyCode[key] then
        guiToggleKey = Enum.KeyCode[key]
        keybindBox.Text = "Keybind: " .. key
    else
        keybindBox.Text = "Invalid Key"
    end
end)

-- Toggle GUI visibility with the selected key
UserInputService.InputBegan:Connect(function(input, gameProcessedEvent)
    if not gameProcessedEvent and input.KeyCode == guiToggleKey then
        guiVisible = not guiVisible
        frame.Visible = guiVisible
    end
end)
